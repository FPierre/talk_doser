<!doctype html>
<html lang='fr'>
  <head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>Talk Doser</title>
  </head>
  <body>

    <p>10 mots les plus prononcés</p>
    <ol id='most-used-words'></ol>

    <p>Jour avec le plus d'échanges</p>
    <span id='most-spoken-day'></span>

    <script>
      var request = new XMLHttpRequest()
      var response = {}

      var mostUsedWords = document.getElementById('most-used-words')
      var mostSpokenDay = document.getElementById('most-spoken-day')

      request.onreadystatechange = function () {
        if (request.readyState === 4 && request.status === 200) {
          response = JSON.parse(request.responseText)

          // Most used words

          var tenMostUsedWords = response.words.slice(0, 10)
          var wordsList = ''

          tenMostUsedWords.forEach((word) => {
            wordsList += `<li>${Object.keys(word)[0]} : ${Object.values(word)[0]}</li>`
          })

          mostUsedWords.innerHTML = wordsList

          // Most spoken day

          mostSpokenDay.innerText = `${Object.keys(response.dates[0])[0]} (${Object.values(response.dates[0])[0]} échanges)`
        }
      }

      request.open('GET', 'http://localhost:8081')
      request.send()
    </script>
  </body>
</html>
